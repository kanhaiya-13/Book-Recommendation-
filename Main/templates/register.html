{% extends "layout.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
        <div class="content-section">
            <div class="text-center mb-4">
                <div class="register-icon">
                    <i class="fas fa-user-plus"></i>
                </div>
                <h2 class="text-gradient">Join BookVerse</h2>
                <p class="text-muted">Create your account and start discovering amazing books</p>
            </div>
            
            <form method="POST" action="" class="register-form">
                {{ form.hidden_tag() }}
                
                <div class="form-grp">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">
                                <i class="fas fa-user"></i>
                            </span>
                        </div>
                        {{ form.username(class="form-control", placeholder="Choose a username") }}
                    </div>
                    {% if form.username.errors %}
                        <div class="error-message">
                            {% for error in form.username.errors %}
                                <small class="text-danger">
                                    <i class="fas fa-exclamation-circle me-1"></i>{{ error }}
                                </small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <div class="form-grp">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">
                                <i class="fas fa-envelope"></i>
                            </span>
                        </div>
                        {{ form.email(class="form-control", placeholder="Enter your email") }}
                    </div>
                    {% if form.email.errors %}
                        <div class="error-message">
                            {% for error in form.email.errors %}
                                <small class="text-danger">
                                    <i class="fas fa-exclamation-circle me-1"></i>{{ error }}
                                </small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <div class="form-grp">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">
                                <i class="fas fa-lock"></i>
                            </span>
                        </div>
                        {{ form.password(class="form-control", placeholder="Create a password", id="password") }}
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    {% if form.password.errors %}
                        <div class="error-message">
                            {% for error in form.password.errors %}
                                <small class="text-danger">
                                    <i class="fas fa-exclamation-circle me-1"></i>{{ error }}
                                </small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <div class="form-grp">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">
                                <i class="fas fa-lock"></i>
                            </span>
                        </div>
                        {{ form.confirm_pswd(class="form-control", placeholder="Confirm your password", id="confirmPassword") }}
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary" type="button" id="toggleConfirmPassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    {% if form.confirm_pswd.errors %}
                        <div class="error-message">
                            {% for error in form.confirm_pswd.errors %}
                                <small class="text-danger">
                                    <i class="fas fa-exclamation-circle me-1"></i>{{ error }}
                                </small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <!-- Password Strength Indicator -->
                <div class="password-strength">
                    <div class="strength-bar">
                        <div class="strength-fill" id="strengthFill"></div>
                    </div>
                    <small class="strength-text" id="strengthText">Password strength</small>
                </div>

                <div class="form-grp">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="termsCheck" required>
                        <label class="form-check-label" for="termsCheck">
                            I agree to the <a href="#" class="text-gradient">Terms of Service</a> and <a href="#" class="text-gradient">Privacy Policy</a>
                        </label>
                    </div>
                </div>

                <div class="form-grp text-center">
                    {{ form.submit(class="btn btn-outline-info btn-block btn-lg") }}
                </div>
            </form>

            <div class="text-center mt-4">
                <div class="divider">
                    <span>or</span>
                </div>
                
                <div class="social-login">
                    <button class="btn btn-social btn-google">
                        <i class="fab fa-google me-2"></i>Sign up with Google
                    </button>
                    <button class="btn btn-social btn-facebook">
                        <i class="fab fa-facebook-f me-2"></i>Sign up with Facebook
                    </button>
                </div>
            </div>

            <div class="text-center mt-4">
                <small class="text-muted">
                    Already have an account? 
                    <a href="{{ url_for('login') }}" class="text-gradient">Sign in here</a>
                </small>
            </div>
        </div>
    </div>
</div>

<style>
.register-icon {
    font-size: 3rem;
    background: var(--accent-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 1rem;
}

.input-group-text {
    background: var(--glass-bg);
    border: 2px solid var(--glass-border);
    border-right: none;
    color: var(--text-secondary);
    backdrop-filter: blur(10px);
}

.input-group .form-control {
    border-left: none;
    border-radius: 0 15px 15px 0;
}

.input-group-prepend .input-group-text {
    border-radius: 15px 0 0 15px;
}

.error-message {
    margin-top: 0.5rem;
}

.password-strength {
    margin-top: 0.5rem;
}

.strength-bar {
    height: 4px;
    background: var(--glass-border);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 0.25rem;
}

.strength-fill {
    height: 100%;
    width: 0%;
    transition: all 0.3s ease;
    border-radius: 2px;
}

.strength-text {
    color: var(--text-secondary);
    font-size: 0.8rem;
}

.divider {
    position: relative;
    text-align: center;
    margin: 1.5rem 0;
}

.divider::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    height: 1px;
    background: var(--glass-border);
}

.divider span {
    background: var(--primary-gradient);
    padding: 0 1rem;
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.social-login {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.btn-social {
    border-radius: 15px;
    padding: 0.75rem 1rem;
    font-weight: 500;
    transition: var(--transition);
    border: 2px solid var(--glass-border);
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
}

.btn-google {
    color: #db4437;
}

.btn-google:hover {
    background: #db4437;
    color: white;
    transform: translateY(-2px);
}

.btn-facebook {
    color: #4267B2;
}

.btn-facebook:hover {
    background: #4267B2;
    color: white;
    transform: translateY(-2px);
}

.form-check-input:checked {
    background-color: #667eea;
    border-color: #667eea;
}

.form-check-label {
    color: var(--text-primary);
    font-weight: 500;
}
</style>

<script>
// Toggle password visibility
document.getElementById('togglePassword').addEventListener('click', function() {
    const password = document.getElementById('password');
    const icon = this.querySelector('i');
    
    if (password.type === 'password') {
        password.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
    } else {
        password.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
    }
});

document.getElementById('toggleConfirmPassword').addEventListener('click', function() {
    const password = document.getElementById('confirmPassword');
    const icon = this.querySelector('i');
    
    if (password.type === 'password') {
        password.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
    } else {
        password.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
    }
});

// Password strength indicator
document.getElementById('password').addEventListener('input', function() {
    const password = this.value;
    const strengthFill = document.getElementById('strengthFill');
    const strengthText = document.getElementById('strengthText');
    
    let strength = 0;
    let strengthLabel = '';
    let strengthColor = '';
    
    if (password.length >= 8) strength += 1;
    if (/[a-z]/.test(password)) strength += 1;
    if (/[A-Z]/.test(password)) strength += 1;
    if (/[0-9]/.test(password)) strength += 1;
    if (/[^A-Za-z0-9]/.test(password)) strength += 1;
    
    switch (strength) {
        case 0:
        case 1:
            strengthLabel = 'Very Weak';
            strengthColor = '#dc3545';
            break;
        case 2:
            strengthLabel = 'Weak';
            strengthColor = '#fd7e14';
            break;
        case 3:
            strengthLabel = 'Fair';
            strengthColor = '#ffc107';
            break;
        case 4:
            strengthLabel = 'Good';
            strengthColor = '#20c997';
            break;
        case 5:
            strengthLabel = 'Strong';
            strengthColor = '#28a745';
            break;
    }
    
    strengthFill.style.width = (strength * 20) + '%';
    strengthFill.style.background = strengthColor;
    strengthText.textContent = strengthLabel;
    strengthText.style.color = strengthColor;
});

// Add focus effects to form inputs
document.querySelectorAll('.form-control').forEach(input => {
    input.addEventListener('focus', function() {
        this.parentElement.classList.add('focused');
    });
    
    input.addEventListener('blur', function() {
        if (!this.value) {
            this.parentElement.classList.remove('focused');
        }
    });
});
</script>
{% endblock %}